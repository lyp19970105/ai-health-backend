# README.md 更新目标

为了让 AI 助手能快速、全面地理解 `health-monitoring` 后端工程，我将生成一份详细的 README.md 文件。该文件将包含以下核心内容：

## 1. 项目概述 (Project Overview)
- **项目定位**: 作为健康监测应用后端的 **API网关** 和 **业务处理中心**。
- **核心作用**: 连接前端用户与第三方AI服务（如 SiliconFlow, Dify），并管理用户、会话等业务数据。

## 2. 技术栈 (Technology Stack)
- **后端框架**: Spring Boot 3.3.1
- **语言**: Java 17
- **构建工具**: Maven
- **数据库**: Spring Data JPA, Hibernate, MySQL
- **安全**: Spring Security, Spring Session JDBC
- **Web**: Spring MVC (用于 REST API), Spring WebFlux (用于流式响应)
- **API 文档**: SpringDoc (Swagger UI)
- **JSON 处理**: FastJSON2
- **其他**: Lombok

## 3. 项目架构 (Project Architecture)
- **整体结构**: 清晰的分层架构 (Controller -> Service -> Repository/Client)。
- **关键包说明**:
  - `controller`: API 入口，负责处理 HTTP 请求和响应。
  - `service`: 核心业务逻辑层，编排和处理业务流程。
  - `repository`: 数据访问层，负责与数据库交互。
  - `client`: 外部服务客户端，用于调用 Dify 和 SiliconFlow 的 API。
  - `dto`: 数据传输对象，定义 API 的请求和响应体结构。
  - `config`: 应用的各类配置，如 Web、安全、API文档等。
  - `security`: Spring Security 相关配置，如用户详情服务、会话管理。
  - `exception`: 全局异常处理。

## 4. 主要功能模块 (Main Features)
- **用户认证**: 提供注册、登录和获取当前用户信息的标准接口。
- **文本聊天**: 与 AI 进行纯文本的流式对话，支持打字机效果。
- **多模态聊天 (VLM)**: 支持通过 **上传图片** 或 **提供图片 URL** 两种方式进行图文对话。
- **会话管理**: (推断) 记录和查询历史聊天记录。

## 5. 核心 API 端点 (Core API Endpoints)
- `POST /api/auth/login`: 用户登录
- `POST /api/auth/register`: 用户注册
- `GET /api/auth/me`: 获取当前用户信息
- `POST /api/chat/stream`: 纯文本流式聊天
- `POST /api/chat/vlm/stream`: 多模态（图文）流式聊天

## 6. 配置说明 (Configuration)
- **配置文件**: `src/main/resources/application.properties`
- **主要配置项**: 数据库连接信息、Session 存储策略、文件上传大小限制。
- **外部服务**: SiliconFlow 和 Dify 的 API 地址和密钥。
- **安全提示**: 明确指出 API Key 硬编码在配置文件中存在的安全风险，并建议在生产环境中使用环境变量或配置中心等更安全的方式进行管理。

## 7. 如何运行 (How to Run)
- **环境依赖**: 需要本地运行一个 MySQL 数据库，并已创建 `ai_app` 数据库。
- **启动命令**: 使用 `mvn spring-boot:run` 命令，或直接在 IDE 中运行 `HealthMonitoringApplication` 主类。
